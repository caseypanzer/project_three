<% if flash[:message] %>
  <div class="alert">
    <%= flash[:message] %>
  </div>
<% end %>

<!--This is where the search bar, filters, and create button live-->
<nav class="blog-nav">
  <a ng-click="mainCtrl.filterAs('availableItems')" id="availableItems" class="blog-nav-item" href="#">Available items</a>
  <a ng-click="mainCtrl.filterAs('borrowedItems')" id="borrowedItems" class="blog-nav-item" href="#">My borrowed items</a>
  <a ng-click="mainCtrl.filterAs('leantItems')" id="leantItems" class="blog-nav-item" href="#">My lent items</a>
  <a ng-click="mainCtrl.filterAs('listedItems')" id="listedItems" class="blog-nav-item" href="#">My listed items</a>
  <a ng-click="mainCtrl.toggleForm(true)" id="addItem" class="blog-nav-item" href="#">Add an item</a>
  <div class="search">
    <div class="form-group">
      <input class="form-control" type="text" placeholder="Search">
    </div>
  </div>
</nav><!--END OF APP NAVIGATION -->

<div class="container2">
  <div class="post">
  <div class="posts">
  <!--This form adds new listings to the DB -->
  <!--This form will show when a user clicks on the add listing-->
  <form ng-show="mainCtrl.formStatus">
    <small ng-click="mainCtrl.toggleForm(false)">X Close</small>
    <div class="form-group">
      <label>Item Name</label><br>
      <input type="text" class="form-control" required maxlength="70"><br/>
      <label>Item Description</label>
      <textarea class="form-control" rows="5" required maxlength="1000"></textarea><br/>
    <input type="submit" value="Submit" class="btn btn-small">
    </div>
  </form><!-- END OF CREATE LISTING FORM -->

  <!-- available items -->
  <main ng-controller="ItemController as itemCtrl">
  	<section ng-repeat="item in itemCtrl.itemList" ng-show="mainCtrl.filter === 'availableItems'">
  		<div ng-show="item.available && item.user_id != mainCtrl.currentUser.user_id">
  			<div class="title">{{item.title}}</div>
  			<p class="description">{{item.description}}</p>
        <div style="text-align: right">
          <a href="#" class="btn btn-small" style="padding: 6px 16px 7px 16px; ">Borrow me</a>
        </div>
        <br>
      </div>
  	</section>

  	<!--my borrowed items -->
  	<section ng-repeat="item in itemCtrl.itemList" ng-show="mainCtrl.filter === 'borrowedItems'">
  		<div ng-show="item.borrower_id === mainCtrl.currentUser.user_id">
        <div class="title">{{item.title}}</div>
        <p class="description">{{item.description}}</p>
          <div class="user">
            <%= image_tag 'user.png' %>
          </div>
      		<form class="form-group message">
      			<input class="message form-control" type="text" placeholder="Write a message to lender...">
      		</form>
  				<div>message</div>
  				<small>sender</small>
  				<small>time stamp</small>
          <div style="text-align: right">
            <a href="#" class="btn btn-small" style="padding: 6px 16px 7px 16px; ">Return me</a>
          </div>
          <br>
  		</div>
  	</section>

  	<!--my lent items -->
  	<section ng-repeat="item in itemCtrl.itemList" ng-show="mainCtrl.filter === 'leantItems'">
  		<div ng-show="item.borrower_id && item.user_id === mainCtrl.currentUser.user_id">
  			<h3>{{item.title}}</h3>
  			<p>{{item.description}}</p>
  			<form>
  				<input type="text" placeholder="message to borrower">
  			</form>
  			<div>
  				<p>message</p>
  				<small>sender</small>
  				<small>time stamp</small>
  			</div>
  		</div>
  	</section>

  	<!--my listed items -->
  	<section ng-repeat="item in itemCtrl.itemList" ng-show="mainCtrl.filter === 'listedItems'">
  		<div ng-show="item.user_id === mainCtrl.currentUser.user_id && !borrower_id">
        <div class="title">my listed item title</div>
        <p class="description">my listed item description</p>
        <div style="text-align: right">
          <a href="#" class="btn btn-small" style="padding: 6px 16px 7px 16px; ">Edit</a>
          <a href="#" class="btn btn-small" style="padding: 6px 16px 7px 16px; ">Delete</a>
        </div>
        <br><br>
  		</div>
  	</section>
  </main>

  </div>
  </div>
</div>
